{
    "contents" : "#' Read in ornitho data\n#'\n#' Read in the output of the online export from the ornitho homepage based on read.csv2\n#' @param x Character string specifying the name of the file which should be imported\n#' @param simplify Logical, if TRUE (default) the original column names are simplified and the \n#' columns are restricted to that ones, which are most important\n#' @param translate_id Logical, if True (default) the numeric values of the three \"id\"-colums are translated to text strings\n#' @param rm.abs Logical, if TRUE (default) observations with 0 number of individuals are removed \n#' @return Returns a data.frame with imported ornitho data\n#' @export\n\nread.ornitho <- function(x, simplify = T, translate_id = T, rm.abs = T){\n  \n  if(grep(\"txt\",x) != 1)\n    stop(\"Funktion currently only for type .txt available\")\n    \n  # x <- \"E:\\\\Ornitho\\\\data\\\\export_27102014_221710.txt\"\n  x <- read.csv2(x, as.is = TRUE,sep = \"\\t\",fill = TRUE, quote =\"\",dec = \".\")\n  x <- x[-1,]\n  \n  if(simplify){\n    # simplify names in table head\n    names(x) <- gsub(\"ID_SIGHTING\",\"obs_id\", names(x))\n    names(x) <- gsub(\"ID_SPECIES\",\"spec_id\", names(x))\n    names(x) <- gsub(\"NAME_SPECIES\",\"spec_name\", names(x))\n    names(x) <- gsub(\"LATIN_SPECIES\",\"spec_latin\", names(x))\n    names(x) <- gsub(\"SYS_ORDER\",\"order\", names(x))\n    names(x) <- gsub(\"DATE_DAY\",\"day\", names(x))\n    names(x) <- gsub(\"DATE_MONTH\",\"month\", names(x))\n    names(x) <- gsub(\"DATE_YEAR\",\"year\", names(x))\n    names(x) <- gsub(\"DATE_JDAY\",\"jday\", names(x))\n    names(x) <- gsub(\"DATE_PENTADE\",\"pentade\", names(x))\n    names(x) <- gsub(\"DATE_DECADE\",\"decade\", names(x))\n    names(x) <- gsub(\"DATE_WEEK\",\"week\", names(x))\n    names(x) <- gsub(\"DATE\",\"date\", names(x))\n    names(x) <- gsub(\"PLACE\",\"place\", names(x))\n    names(x) <- gsub(\"COUNTY\",\"county\", names(x))\n    names(x) <- gsub(\"COUNTRY\",\"country\", names(x))\n    names(x) <- gsub(\"COORD_LAT\",\"y\", names(x))\n    names(x) <- gsub(\"COORD_LON\",\"x\", names(x))\n    names(x) <- gsub(\"TOTAL_COUNT\",\"count\", names(x))\n    names(x) <- gsub(\"HIDDEN\",\"hidden\", names(x))\n    names(x) <- gsub(\"SURNAME\",\"surname\", names(x))\n    names(x) <- gsub(\"NAME\",\"name\", names(x))\n    names(x) <- gsub(\"DETAIL\",\"detail\", names(x))\n    names(x) <- gsub(\"ATLAS_CODE\",\"atlas_code\", names(x))\n    names(x) <- gsub(\"ALTITUDE\",\"altitude\", names(x))\n    names(x) <- gsub(\"COMMENT\",\"comment\", names(x))\n    names(x) <- gsub(\"PRIVATE_comment\",\"hidden_comment\", names(x))\n    names(x) <- gsub(\"ID_RESTING_HABITAT\",\"id_rest_hab\", names(x))\n    names(x) <- gsub(\"ID_ACCURACY_LOCATION\",\"id_acc_loc\", names(x))\n    names(x) <- gsub(\"ID_OBSERVATION_detail\",\"id_obs_det\", names(x))\n    \n    #vec <- data.frame(id =c(\"ID_SIGHTING\",\"ID_SPECIES\",\"NAME_SPECIES\",\"LATIN_SPECIES\",\"SYS_ORDER\",\"DATE_DAY\",\"DATE_MONTH\",\n     #                       \"DATE_YEAR\",\"DATE_JDAY\",\"DATE_PENTADE\",\"DATE_DECADE\",\"DATE_WEEK\",\"DATE\",\"PLACE\",\"COUNTY\",\n      #                      \"COUNTRY\",\"COORD_LAT\",\"COORD_LON\",\"TOTAL_COUNT\",\"HIDDEN\",\"SURNAME\",\"NAME\",\"DETAIL\",\"ATLAS_CODE\",\n       #                     \"ALTITUDE\",\"COMMENT\",\"PRIVATE_COMMENT\",\"ID_RESTING_HABITAT\",\"ID_ACCURACY_LOCATION\",\"ID_OBSERVATION_detail\")\n        #              meaning = c(\"obs_id\",\"spec_id\" ))\n    \n    #shorten table to data needed\n    x <- x[, c(\"obs_id\", \"spec_id\", \"spec_name\", \"spec_latin\", \"order\",\"hidden\", \n             \"count\", \"detail\", \"atlas_code\",\"altitude\", \n             \"date\", \"day\", \"month\", \"year\", \"jday\", \"pentade\", \"decade\", \"week\",\n             \"place\", \"county\", \"country\", \"y\", \"x\",\"comment\",\"hidden_comment\",\"id_rest_hab\",\"id_acc_loc\",\"id_obs_det\",\n             \"surname\", \"name\")]\n\n    # change formats of single columns\n    x$date <- as.POSIXct(x$date, format = \"%d.%m.%Y\")\n    x$x <- as.numeric(as.character(x$x))\n    x$y <- as.numeric(as.character(x$y))\n    x$count <- as.numeric(as.character(x$count))\n    x$altitude <- as.numeric(as.character(x$altitude))\n    x$order <- as.numeric(as.character(x$order))\n    x$name_complete <- paste(x$surname, x$name)\n    \n    # translate hidden col\n    x$hidden <- gsub(\"Nein\",\"no\", x$hidden)\n    x$hidden <- gsub(\"Ja\",\"yes\", x$hidden)\n    \n    if(translate_id == T){\n      \n      # id_obs_det\n      vec <- data.frame(id =c(\"4_1\", \"4_2\", \"4_3\", \"4_4\", \"4_5\", \"4_6\", \"4_7\", \"4_8\", \"4_9\", \"4_10\", \"4_11\", \"4_12\",\n                              \"4_13\", \"4_14\", \"4_15\", \"4_16\", \"4_17\", \"4_18\", \"4_19\", \"4_20\"), \n                        meaning = c(\"rastend_ruhend\", \"Nahrung suchend\", \"Schlaf_Sammelplatz\",\"Mauserplatz\",\n                                    \"Flug zum_vom Schlafplatz\",\"Flug ins Nahrungsgebiet\",\"überfliegend kein_nicht sicherer Zug\",\n                                    \"N ziehend\",\"NO ziehend\",\"O ziehend\",\"SO ziehend\",\"S ziehend\",\"SW ziehend\",\"W ziehend\",\n                                    \"NW ziehend\",\"Totfund_Rupfung\",\"ziehend ohne Richtungsangabe\",\"Fang zur Beringung\",\n                                    \"Nesterzählung\",\"Gesang_Balz\"))\n      \n      x$id_obs_det <- vec$meaning[match(x$id_obs_det,vec$id)]\n      \n      # id_acc_loc\n      vec <- data.frame(id =c(\"2_1\",\"2_2\", \"2_3\", \"2_4\", \"2_5\"), \n                        meaning = c(\"< 10 m\",\"10–100 m\",\"100–500 m\",\"500–1000 m\",\">1000 m\"))\n      \n      x$id_acc_loc <- vec$meaning[match(x$id_acc_loc,vec$id)]\n      \n      # id_rest_hab\n      vec <- data.frame(id = c(\"1_1\",\"1_2\",\"1_3\",\"1_4\",\"1_5\",\"1_6\",\"1_7\",\"1_8\",\"1_9\",\"1_10\",\"1_11\",\"1_12\",\"1_13\",\"1_14\",\"1_15\",\n                               \"1_16\", \"1_17\", \"1_18\", \"1_19\",\"1_20\"),\n                        meaning = c(\"Brache kein Ackerbrache\",\"Buhnenfeld\",\"Getreidestoppel\",\"Gewässer\",\"Grünland\",\n                                    \"Grünland überschwemmt\",\"Kartoffeln_Kartoffelstoppel\",\"Kleegras_Luzerne\",\"Mais_Maisstoppel\",\n                                    \"Raps_Rapsstoppel\",\"Sommergetreide\",\"Rüben_Rübenstoppel\", \"Salzwiese\", \n                                    \"Acker frisch umgebrochen\", \"Watt_Windwatt\", \"Wintergetreide\", \n                                    \"Sonstiges\", \"Acker überschwemmt\", \"Ackerbrache\",\n                                    \"Stoppelacker unbestimmt\"))\n      \n      x$id_rest_hab <- vec$meaning[match(x$id_rest_hab,vec$id)]\n    }\n    \n    if(rm.abs == T)  # absence punkte entfernen\n      x <- x[x$count != 0, ] \n    \n  }\n  rm(vec)\n  class(x) <- c(\"data.frame\",\"OrnithoData\")\n  return(x)\n}\n",
    "created" : 1424525258265.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "11|72|118|0|\n",
    "hash" : "90999657",
    "id" : "63611F45",
    "lastKnownWriteTime" : 1422788955,
    "path" : "F:/Ornitho/package_ornitho/ornitho/R/read.ornitho.R",
    "project_path" : "R/read.ornitho.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}